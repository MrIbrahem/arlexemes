{% extends "main.html" %}
{% block title %}
<title>API LOGS</title>
{% endblock %}

{% set common_args = {
    'per_page': result.tab.per_page,
    'order': result.tab.order,
    'table_name': result.tab.table_name,
    'filter_data': result.tab.filter_data
} %}

{% set col_class = "col-md-4" %}

{% if result.dbs %}
{% set col_class = "col-md-3" %}
{% endif %}

{% block content %}
</div>
<div class="col-11">
    <div class="card">
        <div class="card-header">
            <span class="card-title mb-0 d-flex align-items-center justify-content-center h4">
                إجمالي استخدام خاصية <a href="https://www.wikidata.org/wiki/Property:P11038" target="_blank">مدخل معجمي
                    في موقع الأنطولوجيا العربية</a>: {{ result.tab.total_logs }}
            </span>
        </div>
        <div class="card-body">
            <!-- Filter Form -->
            <form method="get" action="{{ url_for('view_logs') }}" class="form-inline mb-3 gap-2">
                <input type="text" name="table_name" value="{{ result.tab.table_name }}" hidden />
                <div class="row justify-content-center align-items-center">
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="per_page" class="form-label">في الصفحة</label>
                                    <select name="per_page" id="per_page" class="form-select w-100">
                                        {% for n in [10, 20, 50, 100, 150, 200] %}
                                        <option value="{{ n }}" {% if result.tab.per_page == n %}selected{% endif %}>
                                            {{ n }}
                                        </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label for="order_by" class="form-label">ترتيب</label>
                                    <select name="order_by" id="order_by" class="form-select w-100">
                                        {% for order_type in result.order_by_types %}
                                        <option value="{{ order_type }}"
                                            {% if result.tab.order_by == order_type %}selected{% endif %}>
                                            {{ order_type }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label for="order" class="input-label">تصاعدي/تنازلي</label>
                                <div class="input-group">
                                    <div class="form-control d-flex flex-column">
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="order" id="desc"
                                                value="DESC" {% if result.tab.order == 'DESC' %}checked{% endif %}>
                                            <label class="form-check-label" for="desc">تنازلي</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="order" id="asc"
                                                value="ASC" {% if result.tab.order == 'ASC' %}checked{% endif %}>
                                            <label class="form-check-label" for="asc">تصاعدي</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="filter_data" id="radioDefault1"
                                        value="all" {% if result.tab.filter_data == 'all' %}checked{% endif %}>
                                    <label class="form-check-label" for="radioDefault1">
                                        الكل
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="filter_data" id="radioDefault2"
                                        value="with" {% if result.tab.filter_data == 'with' %}checked{% endif %}>
                                    <label class="form-check-label" for="radioDefault2">
                                        مطابق
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="filter_data" id="radioDefault3"
                                        value="without" {% if result.tab.filter_data == 'without' %}checked{% endif %}>
                                    <label class="form-check-label" for="radioDefault3">
                                        غير مطابق
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-1">
                        <button class="btn btn-primary ms-3" type="submit" onclick1="applySettings()">بدء</button>
                    </div>
                </div>
            </form>
            <div class="row mt-4">
                <div class="col-12">
                    <!-- Pagination Navigation -->
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center">
                            <!-- First page -->
                            <li class="page-item {% if result.tab.page == 1 %}disabled{% endif %}">
                                <a class="page-link" href="{{ url_for('view_logs', page=1, **common_args) }}"
                                    aria-label="First Page">
                                    <span aria-hidden="true">&laquo;&laquo;</span>
                                </a>
                            </li>

                            <!-- Previous page -->
                            <li class="page-item {% if result.tab.page == 1 %}disabled{% endif %}">
                                <a class="page-link"
                                    href="{{ url_for('view_logs', page=result.tab.page-1, **common_args) }}"
                                    aria-label="Previous Page">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>

                            <!-- Page Numbers -->
                            {% for p in range(result.tab.start_page, result.tab.end_page + 1) %}
                            <li class="page-item {% if p == result.tab.page %}active{% endif %}">
                                <a class="page-link" href="{{ url_for('view_logs', page=p, **common_args) }}">
                                    {{ p }}
                                </a>
                            </li>
                            {% endfor %}

                            <!-- Next page -->
                            <li class="page-item {% if result.tab.page == result.tab.total_pages %}disabled{% endif %}">
                                <a class="page-link"
                                    href="{{ url_for('view_logs', page=result.tab.page+1, **common_args) }}"
                                    aria-label="Next Page">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>

                            <!-- Last page -->
                            <li class="page-item {% if result.tab.page == result.tab.total_pages %}disabled{% endif %}">
                                <a class="page-link"
                                    href="{{ url_for('view_logs', page=result.tab.total_pages, **common_args) }}"
                                    aria-label="Last Page">
                                    <span aria-hidden="true">&raquo;&raquo;</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>

                <!-- Page info -->
                <div class="col-12 text-center text-muted">
                    <small>الصفحة {{ result.tab.page }} من {{ result.tab.total_pages }}
                        ({{ result.tab.start_log }} - {{ result.tab.end_log }} من أصل {{ result.tab.total_logs }}
                        عنصر)</small>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <table class="table table-striped table-hover table-bordered soro">
                        <thead>
                            <tr data-dt-order="disable">
                                <th></th>
                                <th colspan="2">lemma</th>
                                <th colspan="2">
                                    قسم الكلام
                                </th>
                                <th colspan="2">sama_lemma</th>
                                <th></th>
                            </tr>
                            <tr>
                                <th>#</th>
                                <th>المُعرّف</th>
                                <th>المدخل المعجمي</th>
                                <th>
                                    <span title="(اسم، فعل، كلمة وظيفية)">
                                        الفئة
                                    </span>
                                </th>
                                <th>
                                    <span title="(اسم، فعل ماضي، صفة، ظرف، ضمير، ... الخ)">
                                        الوسم
                                    </span>
                                </th>
                                <th>المُعرّف</th>
                                <th>المدخل المعجمي</th>
                                <th>معرف ويكي بيانات</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for log in result.logs %}
                            <tr>
                                <!-- { "id": 1, "lemma_id": 2023254709, "lemma": "سَلَاقِيٌّ", "pos": "اسم", "qid": "" } -->
                                <td>{{ loop.index }}</td>
                                <td class="ltr_left">
                                    <a href="https://ontology.birzeit.edu/lemma/{{ log.lemma_id }}" target="_blank">
                                        {{ log.lemma_id }}
                                    </a>
                                </td>
                                <td>
                                    {{ log.lemma }}
                                </td>
                                <td>
                                    {{ log.pos_cat }}
                                </td>
                                <td class="ltr_right">
                                    {{ log.pos }}
                                </td>
                                <td class="ltr_left">
                                    {%if log.sama_lemma_id %}
                                    <a href="https://ontology.birzeit.edu/lemma/{{ log.sama_lemma_id }}"
                                        target="_blank">
                                        {{ log.sama_lemma_id }}
                                    </a>
                                    {%endif%}
                                </td>
                                <td>
                                    {{ log.sama_lemma }}
                                </td>
                                <td>
                                    {%if log.Lid %}
                                    <a href="https://www.wikidata.org/entity/{{log.Lid}}#P11038" target="_blank">
                                        {{log.Lid}}
                                    </a>
                                    {%endif%}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>
{% endblock %}
